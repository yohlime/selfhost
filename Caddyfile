(custom_tls) {
  tls {
    dns cloudflare {$CF_API_TOKEN}
    resolvers 1.1.1.1
  }
}

(default) {
  log {
    level INFO
    output file {$LOG_FILE} {
      roll_size 10MB
      roll_keep 10
    }
  }

  encode zstd gzip
}

{$DOMAIN} {
    reverse_proxy localhost:8088

    import default
    import custom_tls 
}

pihole.{$DOMAIN} {
  reverse_proxy localhost:8080

  import default
  import custom_tls
}

matrix.{$DOMAIN} {
  reverse_proxy /_matrix/* localhost:8008
  reverse_proxy /_synapse/client/* localhost:8008

  import default
  import custom_tls
}

notify.{$DOMAIN} {
  reverse_proxy localhost:8040

  import default
  import custom_tls
}

sync.{$DOMAIN} {
  reverse_proxy localhost:8384 {
    header_up Host {upstream_hostport}
  }

  import default
  import custom_tls 
}

photoprism.{$DOMAIN} {
  reverse_proxy localhost:2342

  import default
  import custom_tls
}

photos.{$DOMAIN} {
  reverse_proxy localhost:2283 {
    header_up Host {host}
    header_up X-Real-IP {remote}
    header_up X-Forwarded-For {remote}
    header_up X-Forwarded-Proto {scheme}
  }

  import default
  import custom_tls
}

dawarich.{$DOMAIN} {
  reverse_proxy localhost:3344

  import default
  import custom_tls
}

chatai.{$DOMAIN} {
  reverse_proxy localhost:3000

  import default
  import custom_tls
}

litellm.{$DOMAIN} {
  reverse_proxy localhost:4000

  import default
  import custom_tls
}

aiostreams.{$DOMAIN} {
  reverse_proxy localhost:3030

  import default
  import custom_tls
}

yamtrack.{$DOMAIN} {
  reverse_proxy localhost:8888

  import default
  import custom_tls
}

postiz.{$DOMAIN} {
  reverse_proxy localhost:5000

  import default
  import custom_tls
}

vert.{$DOMAIN} {
  reverse_proxy localhost:9000

  import default
  import custom_tls
}

vw.{$DOMAIN} {
  reverse_proxy localhost:9999 {
    header_up X-Real-IP {remote_host}
  }

  import default
  import custom_tls
}

lw.{$DOMAIN} {
  reverse_proxy localhost:3333

  import default
  import custom_tls
}

status.{$DOMAIN} {
  reverse_proxy localhost:3001

  import default
  import custom_tls 
}

webdav.{$DOMAIN} {
  basicauth * {
    yoh268 $2y$05$aGDdyUrV6sZK2jJXYYMbq.2A2OctRr0KwOfTt2B8jsvBIbn57/UaG
  }

  root * /webdav
  
  @get method GET
  route {
    file_server @get {
      hide .git .gitignore .stfolder .stversions
      browse
    }

    webdav
  }

  import default
  import custom_tls
}
